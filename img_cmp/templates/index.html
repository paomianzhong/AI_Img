{# Load the tag library #}
{% load bootstrap4 %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript jquery='full' %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block header-content %}
<link rel="stylesheet" href="/static/css/ImageCompare.css" />
<link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
<script src="/static/js/modernizr.js"></script>
<script src="/static/js/jquery-2.1.1.js"></script>
<script src="/static/js/ImageCompare.js"></script>
{{ script|safe }}

{% endblock %}

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <div class="collapse navbar-collapse">
    <form class="form-inline" method="get">
      <label class="my-1 mr-2">Img1</label>
      <select class="custom-select my-1 mr-sm-2" name="img1_platform">
        <option selected value="IOS">{{ selected.0 }}</option>
        <option value="IOS">IOS</option>
        <option value="Android">Android</option>
      </select>

      <select class="custom-select my-1 mr-sm-2" name="img1_version">
        <option selected>{{ selected.1 }}</option>
        {% for v in versions %}
        <option value="{{ v }}">{{ v }}</option>
        {% endfor %}
      </select>

      <label class="my-1 mr-2">Img2</label>
      <select class="custom-select my-1 mr-sm-2" name="img2_platform">
        <option selected value="IOS">{{ selected.2 }}</option>
        <option value="IOS">IOS</option>
        <option value="Android">Android</option>
      </select>

      <select class="custom-select my-1 mr-sm-2" name="img2_version">
        <option selected>{{ selected.3 }}</option>
        {% for v in versions %}
        <option value="{{ v }}">{{ v }}</option>
        {% endfor %}
      </select>

      <select class="custom-select my-1 mr-sm-2" name="resolution">
        <option selected>{{ selected.4 }}</option>
        {% for r in resolutions %}
        <option value="{{ r }}">{{ r }}</option>
        {% endfor %}
      </select>
      <select class="custom-select my-1 mr-sm-2" name="number">
        <option selected>{{ selected.5 }}</option>
        {% for r in numbers %}
        <option value="{{ r }}">{{ r }}</option>
        {% endfor %}
      </select>
      <button type="submit" class="btn btn-primary my-1">Submit</button>
    </form>
  </div>
  <form class="form-inline my-lg-0">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#gradeModal">打分</button>
  </form>
</nav>

<!-- Modal -->
{% if img2 %}
<div class="modal fade" id="gradeModal" tabindex="-1" role="dialog" aria-labelledby="gradeModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="gradeModalLabel">{{ img2.name }}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="post" class="form">
          {% csrf_token %}
          {% bootstrap_form form %}
          {% buttons %}
          <button type="submit" class="btn btn-primary" name="img_id" value="{{ img2.id }}">
            Submit
          </button>
          {% endbuttons %}
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
{% endif %}

<!-- image -->
{% if img2 %}
<div id="demo">
  <div data-type="image-comparison" src1="{{ img1.s3_url }}" src2="{{ img2.s3_url }}"></div>
</div>
{% endif %}

<!-- grade -->
{% if img2 %}
<div id="grade">
  {% for g in grades %}
  <div>{{ g.date }}</div>
  {% endfor %}
</div>
{% endif %}

<script>
	var imageComparisonContainers = $("[data-type='image-comparison']");
	imageComparisonContainers.each(function(){
        new ImageCompare($(this));
    });
</script>

{# Read the documentation for more information #}